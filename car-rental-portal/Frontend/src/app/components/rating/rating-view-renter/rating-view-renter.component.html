<div class="wrap-svg"
     style="display: flex; align-items: center; margin-right: 5px;">

  <button id = "bt" type="button" [attr.id] = "'btnModal' + index" class="btn rate btn-primary" data-bs-toggle="modal" [attr.data-bs-target] = "'#exampleModal' + index" >
    <svg xmlns="http://www.w3.org/2000/svg"
         fill="currentColor" width="16" height="16" style = "color: orange; margin-right: 3px"
         viewBox="0 0 1024 1024" class="icon">
      <path
        d="M908.1 353.1l-253.9-36.9L540.7 86.1c-3.1-6.3-8.2-11.4-14.5-14.5-15.8-7.8-35-1.3-42.9 14.5L369.8 316.2l-253.9 36.9c-7 1-13.4 4.3-18.3 9.3a32.05 32.05 0 0 0 .6 45.3l183.7 179.1-43.4 252.9a31.95 31.95 0 0 0 46.4 33.7L512 754l227.1 119.4c6.2 3.3 13.4 4.4 20.3 3.2 17.4-3 29.1-19.5 26.1-36.9l-43.4-252.9 183.7-179.1c5-4.9 8.3-11.3 9.3-18.3 2.7-17.5-9.5-33.7-27-36.3z" />
    </svg>
    View rate
  </button>
</div>
<div class="modal fade" [attr.id]="'exampleModal' + index" tabindex="-1" aria-labelledby="exampleModalLabel"
     aria-hidden="true">
  <div  [attr.id] = "'viewForm' + index" class="modal-dialog static">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Feedback</h5>
        <button type="button" [attr.id] = "'close' + index" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="car-detail" style="margin-bottom: 15px; cursor: pointer;">
          <div style="margin-right: 10px;">
            <div class="item-car row">
              <div class="row">
                <div class="img-car col-md-4">
                  <div class="fix-img">
                    <img loading="lazy" src="assets/{{image}}" alt="Đây là ảnh đấy">
                  </div>
                </div>
                <div class="desc-car col-md-8">
                  <div class="desc-name">
                    <p>{{name}}</p>
                  </div>
                  <div class="desc-address-price desc-info">
                    <div class="address">
                      <div class="wrap-svg" style="margin-top: 5px; margin-bottom: 5px">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                             xmlns="http://www.w3.org/2000/svg">
                          <path d="M6.86 4.81V2.75" stroke="#767676"
                                stroke-width="1.5" stroke-linecap="round"
                                stroke-linejoin="round"></path>
                          <path d="M17.14 4.81V2.75" stroke="#767676"
                                stroke-width="1.5" stroke-linecap="round"
                                stroke-linejoin="round"></path>
                          <path
                            d="M18.05 3.78003H5.95C4.18 3.78003 2.75 5.21003 2.75 6.98003V18.06C2.75 19.83 4.18 21.26 5.95 21.26H18.06C19.83 21.26 21.26 19.83 21.26 18.06V6.98003C21.25 5.21003 19.82 3.78003 18.05 3.78003Z"
                            stroke="#767676" stroke-width="1.5"
                            stroke-linecap="round" stroke-linejoin="round">
                          </path>
                          <path d="M2.75 7.8999H21.25" stroke="#767676"
                                stroke-width="1.5" stroke-linecap="round"
                                stroke-linejoin="round"></path>
                          <path
                            d="M18 12C18.5523 12 19 11.5523 19 11C19 10.4477 18.5523 10 18 10C17.4477 10 17 10.4477 17 11C17 11.5523 17.4477 12 18 12Z"
                            fill="#767676"></path>
                          <path
                            d="M14 12C14.5523 12 15 11.5523 15 11C15 10.4477 14.5523 10 14 10C13.4477 10 13 10.4477 13 11C13 11.5523 13.4477 12 14 12Z"
                            fill="#767676"></path>
                          <path
                            d="M10 12C10.5523 12 11 11.5523 11 11C11 10.4477 10.5523 10 10 10C9.44772 10 9 10.4477 9 11C9 11.5523 9.44772 12 10 12Z"
                            fill="#767676"></path>
                          <path
                            d="M6 12C6.55228 12 7 11.5523 7 11C7 10.4477 6.55228 10 6 10C5.44772 10 5 10.4477 5 11C5 11.5523 5.44772 12 6 12Z"
                            fill="#767676"></path>
                          <path
                            d="M18 15.49C18.5523 15.49 19 15.0423 19 14.49C19 13.9377 18.5523 13.49 18 13.49C17.4477 13.49 17 13.9377 17 14.49C17 15.0423 17.4477 15.49 18 15.49Z"
                            fill="#767676"></path>
                          <path
                            d="M14 15.49C14.5523 15.49 15 15.0423 15 14.49C15 13.9377 14.5523 13.49 14 13.49C13.4477 13.49 13 13.9377 13 14.49C13 15.0423 13.4477 15.49 14 15.49Z"
                            fill="#767676"></path>
                          <path
                            d="M10 15.49C10.5523 15.49 11 15.0423 11 14.49C11 13.9377 10.5523 13.49 10 13.49C9.44772 13.49 9 13.9377 9 14.49C9 15.0423 9.44772 15.49 10 15.49Z"
                            fill="#767676"></path>
                          <path
                            d="M6 15.49C6.55228 15.49 7 15.0423 7 14.49C7 13.9377 6.55228 13.49 6 13.49C5.44772 13.49 5 13.9377 5 14.49C5 15.0423 5.44772 15.49 6 15.49Z"
                            fill="#767676"></path>
                          <path
                            d="M14 18.97C14.5523 18.97 15 18.5223 15 17.97C15 17.4177 14.5523 16.97 14 16.97C13.4477 16.97 13 17.4177 13 17.97C13 18.5223 13.4477 18.97 14 18.97Z"
                            fill="#767676"></path>
                          <path
                            d="M10 18.97C10.5523 18.97 11 18.5223 11 17.97C11 17.4177 10.5523 16.97 10 16.97C9.44772 16.97 9 17.4177 9 17.97C9 18.5223 9.44772 18.97 10 18.97Z"
                            fill="#767676"></path>
                          <path
                            d="M6 18.97C6.55228 18.97 7 18.5223 7 17.97C7 17.4177 6.55228 16.97 6 16.97C5.44772 16.97 5 17.4177 5 17.97C5 18.5223 5.44772 18.97 6 18.97Z"
                            fill="#767676"></path>
                        </svg>
                        <span style="font-size: 14px;margin-left: 12px;">{{pick + " to " + drop}}</span>
                      </div>
                    </div>

                  </div>

                  <div class="desc-address" style="margin-top: 6px;">
                    <div class="wrap-price">
                      <div style="font-size: 14px" class="price">Total: <span class="price-special">{{price}}</span>VND
                      </div>
                    </div>
                  </div>
                </div>

              </div>
            </div>
          </div>
        </div>
        <div class="line-page"></div>
        <div class="car-detail" *ngFor="let rating of ratings" style="margin-bottom: 15px; cursor: pointer;">
          <div style="margin-right: 10px;">

            <div class="item-car row">
              <div class="row">

                <div class="img-car col-md-4"
                     style="display: flex; justify-content: center; margin-top: 10px; margin-bottom: 10px">
                  <div class="avatar avatar--m">
                    <img loading="lazy"
                         [src]="user?.avatar"
                         alt="Đây là ảnh đấy">
                  </div>
                </div>
                <div class="desc-car col-md-8" style="margin-top: 10px">
                  <div class="desc-name" style="display: flex;justify-content: space-between; height: 10px">
                    <div>
                      <p>
                        {{rating.senderFirstName + ' ' + rating.senderLastName}}
                        <span style="color: #827c7c91" *ngIf="!rating.isRenterFeedback"> (Me)</span>
                        <span style="color: #827c7c91" *ngIf="rating.isRenterFeedback"> (to Me)</span>
                      </p>
                    </div>
                    <div style="font-size: 14px; margin-top: 2px">{{convertDateTime(rating.dateTime)}}</div>
                  </div>
                  <div style="margin-top: 6px;">
                    <div class="star-ratings" title="5 Stars"
                         style="position: relative; box-sizing: border-box; display: inline-block;">
                      <svg class="star-grad"
                           style="position: absolute; z-index: 0; width: 0px; height: 0px; visibility: hidden;">
                        <defs>
                          <linearGradient id="starGrad078528009180899" x1="0%"
                                          y1="0%" x2="100%" y2="0%">
                            <stop offset="0%" class="stop-color-first"
                                  style="stop-color: rgb(255, 198, 52); stop-opacity: 1;">
                            </stop>
                            <stop offset="0%" class="stop-color-first"
                                  style="stop-color: rgb(255, 198, 52); stop-opacity: 1;">
                            </stop>
                            <stop offset="0%" class="stop-color-final"
                                  style="stop-color: rgb(203, 211, 227); stop-opacity: 1;">
                            </stop>
                            <stop offset="100%" class="stop-color-final"
                                  style="stop-color: rgb(203, 211, 227); stop-opacity: 1;">
                            </stop>
                          </linearGradient>
                        </defs>
                      </svg>
                      <div class="star-container"
                           *ngFor="let i of createArray(rating.stars)"
                           style="position: relative; display: inline-block; vertical-align: middle; padding-right: 1px;">
                        <svg viewBox="0 0 51 48" class="widget-svg"
                             style="width: 17px; height: 17px; transition: transform 0.2s ease-in-out 0s;">
                          <path class="star"
                                d="m25,1 6,17h18l-14,11 5,17-15-10-15,10 5-17-14-11h18z"
                                style="fill: rgb(255, 198, 52); transition: fill 0.2s ease-in-out 0s;">
                          </path>
                        </svg>
                      </div>
                    </div>
                  </div>

                  <div style="margin-bottom: 10px;height: 35px;">

                    <p>{{rating.comment}}</p>
                  </div>
                </div>
              </div>

            </div>
          </div>
        </div>
        <div class="modal-footer" style="padding-bottom: 0px">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"
                  style="border: none !important; background-color: transparent !important; color: #007bff !important;">
            Close
          </button>
          <button type="submit" *ngIf="renterRating.canFixed && !checkDateExpired(pickFormatDate)" (click)="switchMode('open')"
                  class="btn btn-primary">Edit
          </button>

        </div>
      </div>
    </div>

  </div>


  <form style="display: none" [attr.id] = "'editForm' + index"  #rateForm="ngForm" (submit)="sendFeedback(rateForm.value)">
    <div class="modal-dialog static">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Feedback</h5>
          <button type="button" class="btn-close" (click)="switchMode('close')"
                  aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="car-detail" style="margin-bottom: 15px; cursor: pointer;">
            <div style="margin-right: 10px;">
              <div class="item-car row">
                <div class="row">
                  <div class="img-car col-md-3">
                    <div class="avatar avatar--m">
                      <img loading="lazy"
                           [src]="user?.avatar"
                           alt="Đây là ảnh đấy">
                    </div>
                  </div>
                  <div class="desc-car col-md-9">
                    <div class="desc-name">
                      <p>{{user?.firstName + ' ' + user?.lastName}}</p>
                    </div>
                    <div class="desc-info-price">
                      <div class="info">
                        <div class="wrap-svg">
                          <svg width="16" height="17" viewBox="0 0 16 17"
                               fill="none" xmlns="http://www.w3.org/2000/svg" class="star-rating">
                            <path
                              d="M14.6667 7.23331C14.7333 6.89998 14.4667 6.49998 14.1333 6.49998L10.3333 5.96665L8.59999 2.49998C8.53333 2.36665 8.46666 2.29998 8.33333 2.23331C7.99999 2.03331 7.59999 2.16665 7.39999 2.49998L5.73333 5.96665L1.93333 6.49998C1.73333 6.49998 1.59999 6.56665 1.53333 6.69998C1.26666 6.96665 1.26666 7.36665 1.53333 7.63331L4.26666 10.3L3.59999 14.1C3.59999 14.2333 3.59999 14.3666 3.66666 14.5C3.86666 14.8333 4.26666 14.9666 4.59999 14.7666L7.99999 12.9666L11.4 14.7666C11.4667 14.8333 11.6 14.8333 11.7333 14.8333C11.8 14.8333 11.8 14.8333 11.8667 14.8333C12.2 14.7666 12.4667 14.4333 12.4 14.0333L11.7333 10.2333L14.4667 7.56665C14.6 7.49998 14.6667 7.36665 14.6667 7.23331Z"
                              fill="#FFC634"></path>
                          </svg>
                        </div>
                        <span style="margin-top: 3px" class="info">{{user?.rating}}</span><span style="margin-top: 3px"
                                                                                                class="dot">•</span>
                        <div class="wrap-svg">
                          <svg width="16" height="16" viewBox="0 0 16 16"
                               fill="none" xmlns="http://www.w3.org/2000/svg"
                               style="margin-right: 4px;">
                            <g clip-path="url(#clip0_1087_41996)">
                              <path
                                d="M10.0625 1.21875C10.0625 1.06369 10.1887 0.9375 10.3438 0.9375H11.9688C12.1238 0.9375 12.25 1.06369 12.25 1.21875V2.89422H13.1875V1.21875C13.1875 0.546719 12.6408 0 11.9688 0H10.3438C9.67172 0 9.125 0.546719 9.125 1.21875V2.89422H10.0625V1.21875Z"
                                fill="#5fcf86"></path>
                              <path
                                d="M5.69806 15.0623C5.49325 14.7441 5.375 14.3673 5.375 13.9686V6.94092H1.09375C0.490656 6.94092 0 7.43157 0 8.03467V13.9686C0 14.5186 0.408156 14.9749 0.9375 15.051V15.5309C0.9375 15.7898 1.14737 15.9997 1.40625 15.9997C1.66513 15.9997 1.875 15.7898 1.875 15.5309V15.0623H5.69806V15.0623ZM1.875 8.65967C1.875 8.40079 2.08487 8.19092 2.34375 8.19092C2.60263 8.19092 2.8125 8.40079 2.8125 8.65967V13.3436C2.8125 13.6024 2.60263 13.8123 2.34375 13.8123C2.08487 13.8123 1.875 13.6024 1.875 13.3436V8.65967Z"
                                fill="#5fcf86"></path>
                              <path
                                d="M4.375 5.26562C4.375 5.11056 4.50119 4.98438 4.65625 4.98438H5.375V4.92547C5.375 4.61094 5.44687 4.31291 5.57506 4.04688H4.65625C3.98422 4.04688 3.4375 4.59359 3.4375 5.26562V6.00359H4.375V5.26562Z"
                                fill="#5fcf86"></path>
                              <path
                                d="M14.9062 3.83154H7.40625C6.80316 3.83154 6.3125 4.3222 6.3125 4.92529V13.9686C6.3125 14.5186 6.72066 14.9749 7.25 15.051V15.5309C7.25 15.7898 7.45987 15.9997 7.71875 15.9997C7.97763 15.9997 8.1875 15.7898 8.1875 15.5309V15.0623H14.125V15.5309C14.125 15.7898 14.3349 15.9997 14.5938 15.9997C14.8526 15.9997 15.0625 15.7898 15.0625 15.5309V15.051C15.5918 14.9749 16 14.5186 16 13.9686V4.92529C16 4.32217 15.5093 3.83154 14.9062 3.83154ZM9.125 13.3436C9.125 13.6024 8.91513 13.8123 8.65625 13.8123C8.39737 13.8123 8.1875 13.6024 8.1875 13.3436V5.55029C8.1875 5.29142 8.39737 5.08154 8.65625 5.08154C8.91513 5.08154 9.125 5.29142 9.125 5.55029V13.3436ZM13.6562 13.8123C13.3974 13.8123 13.1875 13.6024 13.1875 13.3436V5.55029C13.1875 5.29142 13.3974 5.08154 13.6562 5.08154C13.9151 5.08154 14.125 5.29142 14.125 5.55029V13.3436C14.125 13.6024 13.9151 13.8123 13.6562 13.8123Z"
                                fill="#5fcf86"></path>
                            </g>
                            <defs>
                              <clipPath id="clip0_1087_41996">
                                <rect width="16" height="16" fill="white"></rect>
                              </clipPath>
                            </defs>
                          </svg>
                        </div>
                        <span style="margin-top: 3px" class="info">{{user?.noBooking}} rides</span>
                      </div>
                    </div>

                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="line-page"></div>
          <div class="label-rating">Rate:</div>
          <div class="container">
            <div class="container__items">
              <input type="radio" (click)="fillStar('s5')" [attr.name]="'star' + index" [attr.id]="'st5' + index">
              <label [attr.id]="'st15' + index"  [attr.for]="'st5' + index">
                <div class="star-stroke">
                  <div class="star-fill"></div>
                </div>
                <div class="label-description" data-content="Excellent"></div>
              </label>
              <input  type="radio" (click)="fillStar('s4')" [attr.name]="'star' + index" [attr.id]="'st4' + index">
              <label [attr.id]="'st14' + index"  [attr.for]="'st4' + index">
                <div class="star-stroke">
                  <div class="star-fill"></div>
                </div>
                <div class="label-description" data-content="Good"></div>
              </label>
              <input type="radio" (click)="fillStar('s3')" [attr.name]="'star' + index" [attr.id]="'st3' + index">
              <label [attr.id]="'st13' + index" [attr.for]="'st3' + index">
                <div class="star-stroke">
                  <div class="star-fill"></div>
                </div>
                <div class="label-description" data-content="OK"></div>
              </label>
              <input [attr.for] = "'st2' + index" type="radio" (click)="fillStar('s2')" [attr.name]="'star' + index" [attr.id]="'st2' + index">
              <label [attr.id]="'st12' + index" [attr.for]="'st2' + index">
                <div class="star-stroke">
                  <div class="star-fill"></div>
                </div>
                <div class="label-description" data-content="Bad"></div>
              </label>
              <input  type="radio" (click)="fillStar('s1')" #s1 [attr.name]="'star' + index" [attr.id]="'st1' + index">
              <label [attr.id]="'st11' + index"  [attr.for]="'st1' + index">
                <div class="star-stroke">
                  <div class="star-fill"></div>
                </div>

                <div class="label-description" data-content="Terrible"></div>
              </label>
            </div>
          </div>
          <div class="comment-field">
            <div class="form-outline">
              <label class="form-label" for="textAreaExample">Comment:</label>
              <textarea  maxlength="100" [required]="true" [(ngModel)]="comment" name="comment" class="form-control" id="textAreaExample"
                         rows="4"></textarea>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" (click)="switchMode('close')"
                  style="border: none !important; background-color: transparent !important; color: #007bff !important;">
            Close
          </button>
          <button type="submit"  (click)="switchMode('close')"
                  [disabled]="rateForm.invalid || star == 0"
                  class="btn btn-primary">Send
          </button>
        </div>
      </div>

    </div>
  </form>
</div>




